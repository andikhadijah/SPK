{% extends 'base.html' %}
{% block title %}Proses Perhitungan{% endblock %}

{% block content %}

<!-- ====================================================== -->
<!--    LOAD DATATABLES  (WAJIB ADA)                        -->
<!-- ====================================================== -->
<link rel="stylesheet" 
href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
<link rel="stylesheet" 
href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.dataTables.min.css">

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script 
src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script 
src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>

<style>
.dt-container {
  padding: 5px;
}
h3 {
  margin-top: 35px;
  color: #d63384;
}
.table-box {
  background: white;
  padding: 12px;
  border-radius: 12px;
  margin-bottom: 25px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.06);
}
</style>

<div style="background:white; padding:20px; border-radius:12px; box-shadow:0 8px 24px rgba(0,0,0,0.06);">
  <h2 style="color:#d63384;">üîé Tahap Perhitungan SAW, TOPSIS & Hybrid</h2>
  <p>Berikut adalah proses perhitungan lengkap berdasarkan provinsi yang Anda pilih.</p>
</div>

<br>


<!-- ====================================================== -->
<!--                     1. NORMALISASI SAW                 -->
<!-- ====================================================== -->
<div class="table-box">
<h3>1. Normalisasi SAW</h3>

<table id="t1" class="display nowrap" style="width:100%;">
<thead>
<tr>
  <th>No</th>
  <th>Produksi</th>
  <th>Provinsi</th>
  <th>Volume</th>
  <th>Nilai</th>
  <th>Harga</th>
</tr>
</thead>
<tbody>
{% for name in matrices.index %}
<tr>
  <td>{{ loop.index }}</td>
  <td>{{ name }}</td>
  <td>{{ matrices.provinsi[loop.index0] }}</td>
  {% for val in matrices.saw_norm[loop.index0] %}
  <td>{{ "%.6f"|format(val) }}</td>
  {% endfor %}
</tr>
{% endfor %}
</tbody>
</table>
</div>


<!-- ====================================================== -->
<!--                     2. SKOR SAW                        -->
<!-- ====================================================== -->
<div class="table-box">
<h3>2. Skor SAW (S·µ¢)</h3>

<table id="t2" class="display nowrap" style="width:100%;">
<thead>
<tr>
  <th>No</th>
  <th>Produksi</th>
  <th>Provinsi</th>
  <th>Skor SAW</th>
</tr>
</thead>
<tbody>
{% for name in matrices.index %}
<tr>
  <td>{{ loop.index }}</td>
  <td>{{ name }}</td>
  <td>{{ matrices.provinsi[loop.index0] }}</td>
  <td>{{ "%.6f"|format(matrices.saw_scores[loop.index0]) }}</td>
</tr>
{% endfor %}
</tbody>
</table>
</div>



<!-- ====================================================== -->
<!--          3. NORMALISASI TOPSIS (r·µ¢‚±º)                  -->
<!-- ====================================================== -->
<div class="table-box">
<h3>3. Normalisasi TOPSIS (r·µ¢‚±º)</h3>

<table id="t3" class="display nowrap" style="width:100%;">
<thead>
<tr>
  <th>No</th>
  <th>Produksi</th>
  <th>Provinsi</th>
  <th>Volume</th>
  <th>Nilai</th>
  <th>Harga</th>
</tr>
</thead>
<tbody>
{% for name in matrices.index %}
<tr>
  <td>{{ loop.index }}</td>
  <td>{{ name }}</td>
  <td>{{ matrices.provinsi[loop.index0] }}</td>
  {% for val in matrices.topsis_r[loop.index0] %}
  <td>{{ "%.6f"|format(val) }}</td>
  {% endfor %}
</tr>
{% endfor %}
</tbody>
</table>
</div>



<!-- ====================================================== -->
<!--                  4. Matriks v·µ¢‚±º                       -->
<!-- ====================================================== -->
<div class="table-box">
<h3>4. Matriks v·µ¢‚±º (Bobot √ó Normalisasi)</h3>

<table id="t4" class="display nowrap" style="width:100%;">
<thead>
<tr>
  <th>No</th>
  <th>Produksi</th>
  <th>Provinsi</th>
  <th>Volume</th>
  <th>Nilai</th>
  <th>Harga</th>
</tr>
</thead>
<tbody>
{% for name in matrices.index %}
<tr>
  <td>{{ loop.index }}</td>
  <td>{{ name }}</td>
  <td>{{ matrices.provinsi[loop.index0] }}</td>
  {% for val in matrices.topsis_v[loop.index0] %}
  <td>{{ "%.6f"|format(val) }}</td>
  {% endfor %}
</tr>
{% endfor %}
</tbody>
</table>
</div>



<!-- ====================================================== -->
<!--            5. A+ Ideal & A- Anti-Ideal                -->
<!-- ====================================================== -->
<div class="table-box">
<h3>5. Nilai Ideal Positif (A‚Å∫) & Negatif (A‚Åª)</h3>

<table id="t5" class="display nowrap" style="width:100%;">
<thead>
<tr>
  <th>Kriteria</th>
  <th>A‚Å∫</th>
  <th>A‚Åª</th>
</tr>
</thead>
<tbody>
{% for k in matrices.v_pos %}
<tr>
  <td>K{{ loop.index }}</td>
  <td>{{ "%.6f"|format(matrices.v_pos[loop.index0]) }}</td>
  <td>{{ "%.6f"|format(matrices.v_neg[loop.index0]) }}</td>
</tr>
{% endfor %}
</tbody>
</table>
</div>



<!-- ====================================================== -->
<!--                       6. D+ & D-                       -->
<!-- ====================================================== -->
<div class="table-box">
<h3>6. Jarak ke Ideal (D‚Å∫) & Anti-Ideal (D‚Åª)</h3>

<table id="t6" class="display nowrap" style="width:100%;">
<thead>
<tr>
  <th>No</th>
  <th>Produksi</th>
  <th>Provinsi</th>
  <th>D‚Å∫</th>
  <th>D‚Åª</th>
</tr>
</thead>
<tbody>
{% for name in matrices.index %}
<tr>
  <td>{{ loop.index }}</td>
  <td>{{ name }}</td>
  <td>{{ matrices.provinsi[loop.index0] }}</td>
  <td>{{ "%.6f"|format(matrices.d_pos[loop.index0]) }}</td>
  <td>{{ "%.6f"|format(matrices.d_neg[loop.index0]) }}</td>
</tr>
{% endfor %}
</tbody>
</table>
</div>



<!-- ====================================================== -->
<!--                    7. Skor TOPSIS                      -->
<!-- ====================================================== -->
<div class="table-box">
<h3>7. Skor TOPSIS (C·µ¢*)</h3>

<table id="t7" class="display nowrap" style="width:100%;">
<thead>
<tr>
  <th>No</th>
  <th>Produksi</th>
  <th>Provinsi</th>
  <th>Skor TOPSIS</th>
</tr>
</thead>
<tbody>
{% for name in matrices.index %}
<tr>
  <td>{{ loop.index }}</td>
  <td>{{ name }}</td>
  <td>{{ matrices.provinsi[loop.index0] }}</td>
  <td>{{ "%.6f"|format(matrices.topsis_scores[loop.index0]) }}</td>
</tr>
{% endfor %}
</tbody>
</table>
</div>



<!-- ====================================================== -->
<!--                    BUTTON KE PERINGKAT                 -->
<!-- ====================================================== -->
<div style="text-align:center; margin-top:30px;">
  <a href="{{ url_for('results') }}" 
     style="padding:14px 24px; background:#d63384; color:white; border-radius:12px;
            font-weight:600; text-decoration:none;">
    üëâ Lihat Hasil Perankingan Akhir
  </a>
</div>


<!-- ====================================================== -->
<!--        INIT DATATABLES UNTUK SEMUA TABEL               -->
<!-- ====================================================== -->
<script>
$(document).ready(function(){
  $('#t1, #t2, #t3, #t4, #t5, #t6, #t7').DataTable({
    responsive: true,
    pageLength: 5,
    lengthMenu: [[5,10,20,-1],[5,10,20,"Semua"]],
    language: {
      search: "Cari:",
      lengthMenu: "Tampilkan _MENU_ baris",
      info: "Menampilkan _START_‚Äì_END_ dari _TOTAL_ data",
      paginate: {
        next: "‚û°",
        previous: "‚¨Ö"
      }
    }
  });
});
</script>

{% endblock %}
